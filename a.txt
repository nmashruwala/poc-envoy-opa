Unable to parse JSON as proto (INVALID_ARGUMENT: invalid JSON  in   envoy.config.bootstrap.v3.Bootstrap @ static_resources.secrets[0].generic_secret.secret:   message envoy.config.core.v3.DataSource, near  1:82  (offset 81): unexpected  character:  '"'; expected '{'): {"static_resources":{"secrets":[{"name":"oidc-secret","generic_secret":{"secret":"60Op4HFM0I8ajz0WdiStAbziZ-VFQttXuxixHHs2R7r7-CW8GR79l-mmLqMhc-Sa"}},{"generic_secret":{"secret":"e013178020d691909f1215e68236ebb270277a567cce2fdb1314f2535ab67943"},"name":"hmac"}],"clusters":[{"type":"STRICT_DNS","name":"test","lb_policy":"ROUND_ROBIN","load_assignment":{"cluster_name":"test","endpoints":[{"lb_endpoints":[{"endpoint":{"address":{"socket_address":{"port_value":9888,"address":"127.0.0.1"}}}}]}]}}],"listeners":[{"listener_filters":[{"typed_config":{"@type":"type.googleapis.com/envoy.extensions.filters.listener.tls_inspector.v3.TlsInspector"},"name":"tls_inspector"}],"filter_chains":[{"transport_socket":{"name":"envoy.transport_sockets.tls","typed_config":{"require_client_certificate":true,"@type":"type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.DownstreamTlsContext","common_tls_context":{"tls_certificates":[{"certificate_chain":{"filename":"/var/run/autocert.step.sm/site.crt"},"private_key":{"filename":"/var/run/autocert.step.sm/site.key"}}],"validation_context":{"trusted_ca":{"filename":"/var/run/autocert.step.sm/root.crt"}}}}},"filter_chain_match":{"transport_protocol":"tls"},"filters":[{"name":"envoy.filters.network.http_connection_manager","typed_config":{"http_filters":[{"typed_config":{"@type":"type.googleapis.com/envoy.extensions.filters.http.lua.v3.Lua","inline_code":"function envoy_on_request(request_handle)\n  local stream_info = request_handle:streamInfo()\n  local ssl_connection_info = stream_info:downstreamSslConnection()\n  if ssl_connection_info:peerCertificatePresented() then\n    print(\"peer certificate is presented\")\n    request_handle:logInfo(\"Downstream connection is using MTLS\")\n    request_handle:headers():add(\"x-forwarded-client-cert\", \"true\")\n  end\n  request_handle:headers():add(\"X-Path\", request_handle:headers():get(\":path\"))\nend\n"},"name":"envoy.filters.http.lua"},{"typed_config":{"@type":"type.googleapis.com/envoy.extensions.filters.http.oauth2.v3.OAuth2","config":{"credentials":{"hmac_secret":{"name":"hmac"},"client_id":"kbyuFDidLLm280LIwVFiazOqjO3ty8KH","token_secret":{"name":"oidc-secret"}},"signout_path":{"path":{"exact":"/signout"}},"auth_scopes":["email"],"token_endpoint":{"uri":"oauth.com/token","timeout":"3s","cluster":"oauth"},"redirect_uri":"%REQ(x-forwarded-proto)%://%REQ(:authority)%/callback","redirect_path_matcher":{"path":{"exact":"/callback"}},"authorization_endpoint":"https://samples.auth0.com/authorize","pass_through_matcher":[{"present_match":true,"name":"x-forwarded-client-cert"}]}},"name":"envoy.filters.http.oauth2"},{"name":"envoy.filters.http.router","typed_config":{"@type":"type.googleapis.com/envoy.extensions.filters.http.router.v3.Router"}}],"@type":"type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager","stat_prefix":"ingress_https","route_config":{"name":"local_route","virtual_hosts":[{"routes":[{"route":{"cluster":"test","timeout":"0s"},"match":{"prefix":"/"}}],"domains":["*"],"name":"app"}]},"upgrade_configs":[{"upgrade_type":"websocket"}],"codec_type":"AUTO"}}]}],"address":{"socket_address":{"address":"0.0.0.0","port_value":13334}}}]},"admin":{"address":{"socket_address":{"port_value":9901,"address":"127.0.0.1"}}}}
[2024-11-21 02:23:20,691][1][INFO][hot-restarter.py:131] got SIGCHLD